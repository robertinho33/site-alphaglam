 <!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AlphaGlam - Cosm√©ticos</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css">
    <link rel="stylesheet" href="../assets/css/style.css">
</head>
<body>
     <header>

        <div class="container d-flex justify-content-between align-items-center">
            <a href="#" class="navbar-brand fw-bold">AlphaGlam Marketplace</a>
            <form class="d-flex w-50">
                <input class="form-control me-2" type="search" placeholder="Buscar produtos..." aria-label="Search">
                <button class="btn btn-dark" type="submit">Buscar</button>
                <form id="search-form" class="d-flex w-50">
                    <select id="category-filter" class="form-select me-2">
                        <option value="">Todas as Categorias</option>
                        <option value="cabelos">Cabelos</option>
                        <option value="pele">Pele</option>
                        <option value="maquiagem">Maquiagem</option>
                        <option value="unhas">Unhas</option>
                        <option value="unhas">xc</option>
                        <option value="unhas">xcc</option>
                        <option value="unhas">cx</option>
                    </select>
                    <form action="">
                    <input id="search-input" class="form-control me-2" type="search" placeholder="Buscar produtos..." aria-label="Search">
                    <button class="btn btn-dark" type="submit">Buscar</button>
                </form>

                <form class="d-flex w-50" onsubmit="return false;">
                    <input id="search-input" class="form-control me-2" type="search" placeholder="Busca busca..." aria-label="Search">
                    <button id="search-btn" class="btn btn-dark" type="button">Buscar</button>
                </form>
                
            </form>
            <div>

                
        <nav class="navbar navbar-expand-lg navbar-light bg-light">
            <div class="container-fluid">
                <a class="navbar-brand" href="../index.html">AlphaGlam</a>
                <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
                    <span class="navbar-toggler-icon"></span>
                </button>
                <div class="collapse navbar-collapse" id="navbarNav">
                    <div id="menu-container"></div> <!-- Aqui ser√° inserido o conte√∫do do menu -->
                </div>
            </div>
        </nav>
    </header>
<body>
    <!-- Bot√µes Flutuantes -->
<div class="floating-buttons">
    <button id="floating-cart-btn" class="btn btn-warning">üõí Ver Carrinho</button>
    <button id="floating-checkout-btn" class="btn btn-success">‚úÖ Finalizar Compra</button>
</div>

    <div class="container my-5">
        <h1 class="text-center mb-4">Produtos</h1>

        <!-- Bot√µes para alternar entre Produtos e Carrinho -->
        <div class="text-center mb-4">
            <button id="view-products-btn" class="btn btn-primary">Voltarr √†s Compras</button>
            <button id="view-cart-btn" class="btn btn-secondary">Ver Carrinho</button>
        
        </div>
            <!-- Produtos -->
            <div id="products-container" class="row col-mb-4">
            <!-- Os cards ser√£o inseridos aqui dinamicamente -->
            </div>
      
        <!-- Carrinho -->
<div id="cart-container" style="display: none;">
    <h2 class="text-center mb-4">Carrinho</h2>
    <ul id="cart-list" class="list-group">
        <!-- Os produtos do carrinho ser√£o exibidos aqui -->
    </ul>
    <div class="text-center mt-4">
        <p><strong>Total:</strong> R$ <span id="cart-total">0.00</span></p>
        <a href="#" id="whatsapp-button" target="_blank" class="btn btn-success">
            Finalizar Pedido no WhatsApp
        </a>
    </div>
</div>

   <!-- Modal para exibir descri√ß√£o completa -->
<div class="modal fade" id="descriptionModal" tabindex="-1" aria-labelledby="descriptionModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="descriptionModalLabel">Descri√ß√£o Completa <p>Aproveite essa oferta!</p></h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                <p id="fullDescription"></p>
            </div>
            <div class="modal-footer">
                <button id="addToCartModal" class="btn btn-primary">
                    Adicionar ao Carrinho
                </button>
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Fechar</button>
            </div>
        </div>
    </div>
</div>

    <script>

        const cart = [];
        document.addEventListener("DOMContentLoaded", async () => {
    const productsContainer = document.getElementById("products-container");
    const cartContainer = document.getElementById("cart-container");

    // Certifique-se de que o carrinho est√° escondido inicialmente
    cartContainer.style.display = "none";

    // Bot√£o para ver os produtos
    document.getElementById("view-products-btn").addEventListener("click", () => {
        productsContainer.style.display = "flex";
        cartContainer.style.display = "none";
    });

    // Bot√£o para ver o carrinho
    document.getElementById("view-cart-btn").addEventListener("click", () => {
        productsContainer.style.display = "none";
        cartContainer.style.display = "block";
        updateCartView(); // Atualiza a exibi√ß√£o do carrinho
    });
});

    
        // Fun√ß√£o para adicionar produto ao carrinho
        function addToCart(product) {
            cart.push(product);
            alert(`Produto "${product.title}" adicionado ao carrinho!`);
            updateCartView();
        }
        function updateCartView() {
    const cartList = document.getElementById("cart-list");
    const cartTotal = document.getElementById("cart-total");

    cartList.innerHTML = ""; // Limpa o carrinho antes de atualizar

    if (cart.length === 0) {
        cartList.innerHTML = '<li class="list-group-item text-center">O carrinho est√° vazio.</li>';
        cartTotal.textContent = "0.00";
    } else {
        cart.forEach((product, index) => {
            const listItem = document.createElement("li");
            listItem.classList.add("list-group-item", "d-flex", "justify-content-between", "align-items-center");
            listItem.innerHTML = `
                ${product.title} - R$ ${parseFloat(product.price).toFixed(2)}
                <button class="btn btn-danger btn-sm" onclick="removeFromCart(${index})">Remover</button>
            `;
            cartList.appendChild(listItem);
        });
        cartTotal.textContent = calculateCartTotal();
    }

    updateWhatsAppButton(); // Atualiza link do WhatsApp
}

    
        // Fun√ß√£o para remover produto do carrinho
        function removeFromCart(index) {
            cart.splice(index, 1);
            alert("Produto removido do carrinho!");
            updateCartView();
        }
    
        // Calcular total do carrinho
        function calculateCartTotal() {
            return cart.reduce((total, product) => total + parseFloat(product.price), 0).toFixed(2);
        }
    
        // Gerar mensagem para WhatsApp
        function generateWhatsAppMessage() {
            if (cart.length === 0) {
                return "Meu carrinho est√° vazio.";
            }
    
            let message = "Ol√°, gostaria de realizar o seguinte pedido:\n\n";
            cart.forEach((product, index) => {
                message += `${index + 1}. ${product.title} - R$ ${parseFloat(product.price).toFixed(2)}\n`;
            });
            message += `\nTotal: R$ ${calculateCartTotal()}`;
    
            return message;
        }
    
       // Atualizar bot√£o do WhatsApp
function updateWhatsAppButton() {
    const whatsappButton = document.getElementById("whatsapp-button");
    const message = encodeURIComponent(generateWhatsAppMessage());
    
    // Se o carrinho estiver vazio, n√£o muda o link
    if (cart.length === 0) {
        whatsappButton.href = "#";
        return;
    }

    whatsappButton.href = `https://wa.me/5511986215473?text=${message}`;

    // Adiciona um evento para limpar o carrinho ao clicar no bot√£o
    whatsappButton.addEventListener("click", () => {
        setTimeout(() => {
            cart.length = 0; // Esvazia o array do carrinho
            updateCartView(); // Atualiza a exibi√ß√£o
            alert("Pedido enviado! O carrinho foi esvaziado.");
        }, 1000); // Pequeno delay para garantir que a mensagem foi enviada antes de limpar
    }, { once: true }); // Garante que o evento s√≥ ser√° anexado uma vez
}
            // Renderizar produtos
           function renderProducts(products) {
    const container = document.getElementById("products-container");
    container.innerHTML = ""; // Limpa o container antes de renderizar
    products.forEach((product) => {
        const truncatedDescription = product.description.length > 80 
            ? product.description.slice(0, 80) + "..." 
            : product.description;

        const card = document.createElement("div");
        card.classList.add("col-md-4");
        card.innerHTML = `
         <section class="container mt-5">
        <div class="row">     
            <div class="card"> 
                <p class="card-text"><strong>ID:</strong> ${product.id}</p>
               <h5> ${product.title}</h5>
                <img 
                    src="../assets/images/ecobelle/${product.image}" 
                    class="card-img-top img-thumbnail" 
                    alt="${product.title}" 
                >
                <p class="card-text">
                    <strong>Descri√ß√£o:</strong> ${truncatedDescription}
                    <a href="#" class="text-primary" onclick="showFullDescription('${product.description}')">Leia mais</a>
                </p> 
                <div class="card-footer">
                    <small class="text-muted"><strong>Pre√ßo:</strong> R$ ${parseFloat(product.price).toFixed(2)}</small>
                </div> 
                <button class="btn btn-primary cart-button" onclick='addToCart(${JSON.stringify(product)})'>
                    Adicionar ao Carrinho
                </button>
            </div>
            </div>
        `;
        container.appendChild(card);
    });
}

    function showFullDescription(description) {
    const fullDescriptionElement = document.getElementById("fullDescription");
    fullDescriptionElement.textContent = description; // Define a descri√ß√£o completa no modal
    const descriptionModal = new bootstrap.Modal(document.getElementById("descriptionModal"));
    descriptionModal.show(); // Abre o modal
}

        // Atualizar exibi√ß√£o do carrinho
       function updateCartView() {
    const cartList = document.getElementById("cart-list");
    const cartTotal = document.getElementById("cart-total");

    cartList.innerHTML = ""; // Limpa o carrinho antes de atualizar

    if (cart.length === 0) {
        cartList.innerHTML = '<li class="list-group-item text-center">O carrinho est√° vazio.</li>';
        cartTotal.textContent = "0.00";
    } else {
        cart.forEach((product, index) => {
            const listItem = document.createElement("li");
            listItem.classList.add("list-group-item", "d-flex", "justify-content-between", "align-items-center");
            listItem.innerHTML = `
                ${product.title} - R$ ${parseFloat(product.price).toFixed(2)}
                <button class="btn btn-danger btn-sm" onclick="removeFromCart(${index})">Remover</button>
            `;
            cartList.appendChild(listItem);
        });
        cartTotal.textContent = calculateCartTotal();
    }

    updateWhatsAppButton(); // Atualiza link do WhatsApp
}
    
        // Fun√ß√£o para carregar o CSV
        async function loadCSV(filePath) {
            try {
                const response = await fetch(filePath);
                if (!response.ok) throw new Error('Erro ao carregar o arquivo CSV.');
                const data = await response.text();
                console.log("CSV carregado:", data); // Verifica se o CSV foi carregado corretamente
                return parseCSV(data);
            } catch (error) {
                console.error(error.message);
                return [];
            }
        }
    
        // Fun√ß√£o para processar os dados do CSV
        function parseCSV(data) {
            const lines = data.split('\n').filter(line => line.trim() !== ''); // Remove linhas vazias
            const headers = lines[0].split(',').map(header => header.trim());
            return lines.slice(1).map(line => {
                const values = line.split(',').map(value => value.trim());
                return Object.fromEntries(headers.map((header, index) => [header, values[index]]));
            });
        }
    
        // Inicializar o carregamento dos produtos
        document.addEventListener("DOMContentLoaded", async () => {
            const products = await loadCSV("../controllers/products.csv");
            if (products.length === 0) {
                document.getElementById("products-container").innerHTML =
                    '<p class="text-center">Nenhum produto encontrado.</p>';
            } else {
                renderProducts(products);
            }
    
            // Alternar entre produtos e carrinho
            document.getElementById("view-products-btn").addEventListener("click", () => {
                document.getElementById("products-container").style.display = "flex";
                document.getElementById("cart-container").style.display = "none";
            });
    
            document.getElementById("view-cart-btn").addEventListener("click", () => {
                document.getElementById("products-container").style.display = "none";
                document.getElementById("cart-container").style.display = "block";
            });
        });
    </script>
    

    <div id="footer-container"></div> <!-- Aqui ser√° inserido o conte√∫do do menu -->
        
    <script src="../controllers/main.js"></script> <!-- Verifique se o caminho est√° correto -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>